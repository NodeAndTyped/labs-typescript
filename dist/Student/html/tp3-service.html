<!DOCTYPE html>
<html lang="en">
<head>

    <title>Labs TypeScript</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <link href="//fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Merriweather:400,300,700" rel="stylesheet" type="text/css">

    <link type="text/css" rel="stylesheet" href="styles/materialize.min.css"  media="screen,projection"/>
    <link type="text/css" rel="stylesheet" href="styles/github-markdown.css" />
    <link type="text/css" rel="stylesheet" href="styles/glyph.css" />
    <link type="text/css" rel="stylesheet" href="styles/main.css" />

</head>
<body>

<header class="navbar-fixed">

    <nav class="navbar">
        <div class="nav-wrapper">
            <a href="http://valtech.fr" class="brand-logo">
                <i class="valtech-logo--header glyph" data-icon="valtech-logo" aria-hidden="true"></i>
            </a>

            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
                <li>
                    <a class="dropdown-button" href="#!" data-activates="dropdown1">
                        <i class="material-icons">menu</i>
                    </a>
                </li>
            </ul>


        </div>
    </nav>

</header>

<ul class="side-nav" id="mobile-demo">

    <li class="logo">

        <i class="valtech-logo--header glyph" data-icon="valtech-logo" aria-hidden="true"></i>

    </li>

    
    <li><a href="index.html">Accueil</a></li>
    
    <li><a href="tp1-installation.html">TP1 - Installation</a></li>
    
    <li><a href="tp2-composant.html">TP2 - Création d&#39;un composant</a></li>
    
    <li><a href="tp3-service.html">TP3 - Création d&#39;un service et appel d&#39;un webservice</a></li>
    
    <li><a href="tp4-decorator.html">TP4 - Création d&#39;un décorateur</a></li>
    
    <li><a href="tp5-composant-recherche.html">TP5 - Rechercher une annonce</a></li>
    
    <li><a href="tp6-consultation.html">TP6 - Consultation d&#39;une annonce</a></li>
    
</ul>

<ul id="dropdown1" class="dropdown-content">
    
    <li><a href="index.html">Accueil</a></li>
    
    <li><a href="tp1-installation.html">TP1 - Installation</a></li>
    
    <li><a href="tp2-composant.html">TP2 - Création d&#39;un composant</a></li>
    
    <li><a href="tp3-service.html">TP3 - Création d&#39;un service et appel d&#39;un webservice</a></li>
    
    <li><a href="tp4-decorator.html">TP4 - Création d&#39;un décorateur</a></li>
    
    <li><a href="tp5-composant-recherche.html">TP5 - Rechercher une annonce</a></li>
    
    <li><a href="tp6-consultation.html">TP6 - Consultation d&#39;une annonce</a></li>
    
</ul>

<div class="container">
    <article class="markdown-body">
        <h1>TP 3 - Création d'un service</h1>
<p>Bien que nous n'utilisions pas de framework avancé comme Angular, View.js ou React.js, il est toujours pratique de mettre place
des patterns de conception. Cela permet de structurer rapidement notre code et il est ainsi plus facile à porter vers un autre
framework.</p>
<p>Nous allons donc mettre en place un service qui aura pour objectif d'appeler le webservice <code>api/serviceannoncesimmobilieres</code>
pour récupérer la liste des annonces.</p>
<p>Nous verrons comment utiliser la nouvelle API Fetch pour faire une appel Ajax et commment typer une reponse Ajax pour profiter
de l'analyse statique du code proposé par TypeScript et les IDE tels que Webstorm.</p>
<h3>Créer le service</h3>
<p>Notre service sera nommé <code>RealEstateAdService</code> par convention et aura une methode <code>getAll()</code> qui retournera une Promise
avec pour reponse la liste des annonces.</p>
<h4>Voici le contrat de service</h4>
<ul>
<li>Methode : GET</li>
<li>Url : <code>api/serviceannoncesimmobilieres</code></li>
<li>Réponse : Liste d'annonce</li>
</ul>
<h4>Structure d'une annonce</h4>
<ul>
<li>Id : number,</li>
<li>Titre : string,</li>
<li>Ville : string,</li>
<li>Latitude : number,</li>
<li>Longitude : number,</li>
<li>Achat : boolean,</li>
<li>Location : boolean,</li>
<li>Appartement : boolean,</li>
<li>Maison : boolean,</li>
<li>Chateau : boolean,</li>
<li>Prix : number,</li>
<li>NbrPieces : number,</li>
<li>Surface : number,</li>
<li>Etage : number,</li>
<li>Ascenceur : boolean,</li>
<li>Terrasse : boolean,</li>
<li>Parking : boolean,</li>
<li>Descriptif : string,</li>
<li>ListImagesUrl : tableau de string,</li>
<li>UrlImagePrincipale : tableau de string.</li>
</ul>
<h3>Installation de fetch</h3>
<pre><code class="language-bash">npm install --save whatwg-fetch @types/whatwg-fetch 
</code></pre>
<blockquote>
<p>N'oubliez pas de rajouter whatwg-fetch à la liste des <code>types</code> dans votre <code>tsconfig.json</code> ! </p>
</blockquote>
<h3>Exercice 1</h3>
<p>A partir de la structure d'annonce créer une interface TypeScript correspondant à sa structure.</p>
<h3>Exercice 2</h3>
<p>Créer la classe <code>RealEstateAdService</code> avec une methode <code>getAll()</code>. La methode getAll() doit utiliser l'API
<code>fetch</code> pour appeler le webservice (<a href="https://developer.mozilla.org/fr/docs/Web/API/Fetch_API/Using_Fetch">documentation</a>).</p>
<h3>Exercice 3</h3>
<p>Typer le retour de la methode <code>getAll()</code> de façon à ce qu'elle expose une Promise de liste d'annonce.</p>
<h3>Exercice 4</h3>
<p>Utiliser la méthode <code>getAll()</code> dans l'application pour afficher la liste d'annonce avec notre composant <code>card</code>.</p>
<blockquote>
<p>Correction du TP  : <a href="../../Resources/tp3-solution.zip">tp3-solution</a></p>
</blockquote>
<p><a href="tp4-decorator.html">Suivant</a></p>

    </article>
</div>

<footer class="page-footer">

    <div class="container">

        <div class="row">
            <div class="col l12 s12">
                <p><a href="mailto:info@valtech.fr">info@valtech.fr</a></p>
                <p>Vous avez une vision concernant l'avenir digital de votre entreprise ? N'hésitez pas à nous contacter.</p>
                <p>Tél : 01 76 21 15 00</p>
                <p class="foot__offices">
                    <span>Aarhus | Amserfoort | Amsterdam | Bangalore | Bristol | Buenos Aires | Chicago | Copenhagen | Dallas | Düsseldorf | Eindhoven | Frankfurt | Geneva | Gurgaon | Göteborg | Honolulu | London | Malmö | Manchester | Montreal | Munich | New York | Paris | Singapore | Stockholm | Sydney | Uppsala | Utrecht | Västerås</span>
                </p>
            </div>
        </div>

        <div class="footer-social">
            <ul>
                <li><a href="https://www.facebook.com/valtech.fr"><i class="glyph" data-icon="facebook" title="Suivez-nous à facebook" aria-hidden="true"></i><span class="hidden">facebook</span></a></li>
                <li><a href="https://www.linkedin.com/company/valtech"><i class="glyph" data-icon="linkedin" title="Suivez-nous à linkedin" aria-hidden="true"></i><span class="hidden">linkedin</span></a></li>
                <li><a href="https://www.instagram.com/valtech_fr/"><i class="glyph" data-icon="instagram" title="Suivez-nous à instagram" aria-hidden="true"></i><span class="hidden">instagram</span></a></li>
                <li><a href="https://twitter.com/Valtech_FR"><i class="glyph" data-icon="twitter" title="Suivez-nous à twitter" aria-hidden="true"></i><span class="hidden">twitter</span></a></li>
            </ul>
        </div>



    </div>

    <div class="footer-copyright">
        <div class="container">

            © Valtech 2016

            <a  class="grey-text text-lighten-4 right"  href="/services/mentions-legales-cgu/">
                Mentions légales / CGU
            </a>

            </ul>
        </div>
    </div>

</footer>

<script type="text/javascript" src="scripts/jquery.min.js"></script>
<script type="text/javascript" src="scripts/materialize.min.js"></script>
<script>
    $( document ).ready(function(){
        $(".button-collapse").sideNav();
        $(".dropdown-button").dropdown();
    });
</script>
</body>
</html>